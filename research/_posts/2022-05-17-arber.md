---
layout: post
title: Numerical Heating in PIC simulations
use_math: true
category: research
---

Particle-in-Cell Codes are prone to a phenomenon known as self-heating which results in energy not being conserved over the course of the simulation (need to explain why). This heating typically results in a linear gain of energy over time (source?). 

In the paper by Arber, the authors explore the different factors that contribute to numerical heating in EPOCH. In order to run a simulation with minimal error, we would want the grid size to be very small with respect to relevant length scales of the simulation. For a plasma, the relevant length scale is the Debye Length $\lambda_D$. If we define

\begin{equation}
  r \equiv \frac{\lambda_D}{\Delta x}
\end{equation}

then we would want $r \gg 1$. This paper, however, does not assume that. Additionally, using more macroparticles per cell and a higher order shape function would in general result in a more accurate simulation which would prevent the effects of heating. Also, the number density of particles in the simulation should also affect the energy gain due to the change in the number of interactions of neighboring particles. Finally, the last consideration this paper makes is an option called *current smoothing* which can reduce the effect of numerical Cherenkov radiation. All of these considerations are summarized by the following formula (eq 30 in the paper)

\begin{equation}
        \frac{d T_\text{eV}}{d t_\text{ps}} = \alpha_H \frac{n_{23}^{3/2} \Delta x_\text{nm}^2}{n_\text{ppc}}
\end{equation}

where $\alpha_H$ is an empirically derived factor that depends on both the shape function and presence of current smoothing. 

Here, I will attempt to reproduce the results of Figure 5 from the paper. There, they use a tophat shape function which results in $\alpha_H = 3000$ withhout current smoothing and $\alpha_H = 1000$ when smoothing is turned on. Initially, the plasma starts at a temperature of $T = T_0 = 100 $eV, number of particles per cell $n_{ppc} = 100$, and number density $n_{23} = 1$. This plasma is uniform in density and has a fixed number of cells in each dimension $N_i = 16$ and the simulation volume is varied by using different values of $r = {0.01, 0.1, 0.5, 0.8, 1.1}$ which correspond to cell sizes that are not resolved by the Debye Length. 
