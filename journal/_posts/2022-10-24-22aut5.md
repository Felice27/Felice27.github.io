---
layout: post
title: E Field Fluctuations Model Cont,
use_math: true
category: journal
---


# Deriving Heating Model from E Field Fluctuations

[Previously](https://ronak-n-desai.github.io/osunotebook/22aut2/) I have tried to consider the Hockney calculations regarding the E-Field Fluctuations, but I did not fully examine how this would turn into a heating model. Here, I will finish the calculation. In the Hockney 1971 paper, they state a formula for the time-averaged squared electric field fluctuations (which comes from Plasma Kinetic Theory by Montgomery and Tidman Ch. 8.2)

\begin{equation} \frac{\langle E^2 \rangle}{8 \pi} = \frac{k_B T}{2} \int \int_{-\infty}^{+\infty} \frac{d k_x d k_y}{(2 \pi)^2} \frac{1}{(1 + (k_x^2 + k_y^2) \lambda_D^2)} \end{equation}

which is in units of energy per unit volume. We can convert this integral to polar coordinates by letting $k = \sqrt{k_x^2 + k_y^2}$ and integrating with respect to $k \cdot dk \cdot d\phi$. Also, we can convert the expression from CGS to SI Units

\begin{equation}
\frac{\epsilon_0 \langle E^2 \rangle}{2} = \frac{k_B T}{4 \pi} \int_0^\infty \frac{k dk}{1 + k^2 \lambda_D^2}
\end{equation}

To solve this integral, we let $u \equiv k \lambda_D$ to get

\begin{equation}
\langle E^2 \rangle = \frac{k_B T}{2 \pi \epsilon_0 \lambda_D^2} \int_0^\infty \frac{u du}{1 + u^2}
\end{equation}

which diverges at infinity, so we set limits to the integral 0 and $u_{max}$ which correspond to the maximum relevant wavenumber in our simulation. This can be solved analytically as 

\begin{equation}
\langle E^2 \rangle = \frac{k_B T}{4 \pi \epsilon_0 \lambda_D^2} \text{Log}(1 + u_{max"^2}) \label{eq:e2}
\end{equation}

Here, $u_{max} = 2 \pi \frac{\lambda_D}{\Delta x} R$ where $R$ is some multiplicative factor that tells us where to implement our cutoff. $R = 1$ corresponds to saying that the maximum wavenumber considered is limited the the cell size: $k_{max} = \frac{2 \pi}{\Delta x}$. 

Also, from the Hockney 1971 Paper, they give an estimate of how the squared electric field fluctuations contribute to the kinetic energy increase of one macro particle

\begin{equation}
\Delta KE = \frac{1}{2} m \langle \Delta v^2 \rangle  = \frac{q^2}{m} \langle E^2 \rangle \tau_{corr} t
\end{equation}

where we can identify $\tau_{corr} = \frac{2 \pi}{\omega_{pe}}$ with the plasma period and we already have $\langle E^2 \rangle$. Additionally, we can express the charge of one macroparticle as $q = e \frac{N}{N_{mac}} = \frac{e n}{n_{mac}} = \frac{e n \Delta x^2}{n_{ppc}}$ Combining this all together, we will get 

\begin{equation}
\Delta KE = (\frac{e}{m_e}) \frac{e n \Delta x^2}{n_{ppc}} \frac{k_B T}{4 \pi \epsilon_0 \lambda_D^2} \text{Log}(1 + u_{max}^2) \frac{2 \pi}{\omega_{pe}} t 
\end{equation}

now, we can substitute the expressions for the plasma oscillation frequency and debye length to arrive at 

\begin{equation}
\Delta KE = \frac{n_e^{3/2} \Delta x^2}{n_{ppc}} \text{Log}(1 + u_{max}^2) \sqrt{\frac{e^6}{4 m_e \epsilon_0^3}}
\end{equation}

From here, I can do the same procedure I did with the arber formula and let $n \rightarrow 10^{29} n_{23}$, $\Delta x \rightarrow 10^{-9} \Delta x_{nm}$, and $t \rightarrow 10^{-12} t_{ps}$ to get 

\begin{equation}
\frac{\Delta T_{eV}}{\Delta t_{ps}} = (1.07 \times 10^7 eV) \frac{n_{23}^{3/2} \Delta x_{nm}^2}{n_{ppc}} \text{Log}(1 + u_{max}^2)
\end{equation}

which, to me, does not line up with the heating constant we see in the Arber formula, so I will just call the constant out front $C_H$. Additionally, I will add another hyper-parameter that multiplies the debye ratio called $R$ and when $R=1$, we would arrive at the final formula:

\begin{equation}
\frac{\Delta T_{eV}}{\Delta t_{ps}} = C_H \frac{n_{23}^{3/2} \Delta x_{nm}^2}{n_{ppc}} \text{Log}(1 + 4 \pi^2 (R \frac{\lambda_D}{\Delta x})^2)
\end{equation}

which is identical to the Arber-Model, with the exception of the Log Term. When the cell size resolves the debye length ($\lambda_D > \Delta x$), the log term is very slowly growing as $\Delta x$ gets smaller, but this is overshadowed by the $\Delta x^2$ term outside of the Log. As a result, this would not behave much differently than the Arber formula when the cell size is small, which is in the regime where there is not much numerical heating anyway. 

When the Debye Length is very poorly under-resolved ($\lambda_D \ll \Delta x$), we can simplify the expression as 

\begin{equation}
\frac{\Delta T_{eV}}{\Delta t_{ps}} = C_H \frac{n_{23}^{3/2} \Delta x_{nm}^2}{n_{ppc}} 4 \pi^2 (R \frac{\lambda_D}{\Delta x})^2 = 4 \pi^2 R^2 C_H \frac{n_{23}^{3/2}}{n_{ppc}} \lambda_{D, nm}^2
\end{equation}

which is now no longer dependent on the cell size $\Delta x$. This is consistent with our observation that after a certain cell size is reached, the amount of heating becomes relatively constant.

# Comparison with My Simulations

I restested this model (as well as the alpha and ratio models) with my data that I generated [described here](https://ronak-n-desai.github.io/osunotebook/22aut1/). 

First, I looked at the Arber Model which had a MSE of 20.2. For a more fair comparison, If I allow a hyper-parameter of a heating constant $C_H$ (which is 2 in Arber's Paper for the current settings) I get a slightly better fit with $C_H = 1.8$ which reduced the MSE to 19.6 (improvement is minimal, which shows Arber's Heating Constant to be generally consistent with my data). 

Next, I repeated the Alpha and Ratio Model ([here I gave the same results](https://ronak-n-desai.github.io/osunotebook/22aut3/)) which had MSE of $6.43$ and $3.69$ respectively. 

Finally, I fitted my new model based on E-Field Fluctuations in the Hockney Paper, which I will call the **Hockney Model**, that had a $MSE = 3.25$ which is similar to the ratio model as expected. To enable a more direct comparison with the Arber Model, I set $R = 1$ in the Hockney Model so that there is only one hyper-parameter of the heating constant and got a MSE = 12.64 which is definitely an improvement over the Arber-Model's 19.6. Below, I summarize these results in two tables. In the second table, I did a slightly different model fit where I minimized the MSE considering the percentage error instead of absolute error. 


| Model Type | Parameters | Parameter 1 | Parameter 2 | MSE 1 | 
| ------------------------------------------------------------|
| Arber      |            |             |             |  20.2 |







# Things to Do
- Item 1
- Item 2
